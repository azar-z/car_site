{% extends 'car_rental/base.html' %}
{% load static %}

{% block title %} Car Details {% endblock %}

{% block style %}
    <link rel="stylesheet" type="text/css" href="{% static 'car_rental/stylesheets/car_detail.css' %}">
{% endblock %}

{% block content %}
<div class="container">
    <h1>Car number {{ car.id }}</h1>
{% if car.owner != user %}
    {% if car.is_rented %}
        {% if car.renter != user %}
        <div style="margin-top: 10px" class="alert alert-danger">
            <strong>This car is rented!</strong>
        </div>
        {% else %}
        <div style="margin-top: 10px" class="alert alert-info">
            <strong>This car is rented by you!</strong>
        </div>
        {% endif %}

    {% else %}

        <div style="margin-top: 10px" class="alert alert-success">
            <strong>This car is free to rent!</strong>
        </div>
    {% endif%}
{% endif %}

        <table class="table table-striped table-hover info-table">
            <tr>
                <td>Model</td>
                <td>{{ car.car_type }}</td>
            </tr>
            {% if car.owner != user %}
            <tr>
                <td>Exhibition</td>
                <td>{{ car.owner.username }}</td>
            </tr>
            {% else %}
            <tr>
                <td>Status</td>
                <td>
                    {% if car.is_rented %} rented {% else %} free {% endif %}
                </td>
            </tr>
            {% endif %}
            <tr>
                <td>Price (per hour)</td>
                <td>{{ car.price_per_hour }}</td>
            </tr>
            {% if car.is_rented %}
            {% if car.owner == user or car.renter == user %}
            <tr>
                <td>It is rented from:</td>
                <td>{{ car.rent_start_time }}</td>
            </tr>
            {% endif %}
            <tr>
                <td>It is rented till:</td>
                <td>{{ car.rent_end_time }}</td>
            </tr>
            {% if car.owner == user %}
            <tr>
                <td>Renter</td>
                <td>{{ car.renter.username }}</td>
            </tr>
            {% endif %}
            {% endif %}
        </table>

        {% if not car.is_rented and car.owner != user%}
        <form action="{% url 'car_rental:rent_request' car.id %}" method="post">
        {% csrf_token %}
        <fieldset style="border: #075454 solid 2px; width: 40%; padding: 30px">
        <legend>Want to rent this car?</legend>
            <div class="form-error">
                 {% if error_message %}
                    {{ error_message }}
                 {% endif %}
            </div>
            <table class="table form-table" style="">
                <tr>
                    <td>
                        <label for="rent_start_time">From:</label>
                    </td>
                    <td>
                        <input required id="rent_start_time" name="rent_start_time" type="datetime-local">
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="rent_end_time">Until:</label>
                    </td>
                    <td>
                        <input required id="rent_end_time" name="rent_end_time" type="datetime-local">
                    </td>
                </tr>
            </table>

        <input class="btn btn-info" type="submit" value="Submit Request">
        </fieldset>
        </form>
    {% endif %}

</div>
{% endblock %}