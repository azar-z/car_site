{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Your Requests</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" type="text/css" href="{% static 'car_rental/stylesheets/car_detail.css' %}">
</head>
<body>
<div class="container">
<h1>Your Requests:</h1>
{%if  user.isCarExhibition %}
    {% if requests %}
        <div class="alert alert-info"> Please accept or reject these requests:</div>
        <form action="{% url 'car_rental:answer_requests' %}" method="post">
        {% csrf_token %}
        <table class="table">
        <thead>
        <tr>
            <td>#</td>
            <td>Model</td>
            <td>Plate Number</td>
            <td>Requester</td>
            <td>Start Time</td>
            <td>End Time</td>
            <td>Income</td>
            <td>Take it?</td>
        </tr>
        </thead>
        <tbody>
        {% for request in requests %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ request.car.car_type }}</td>
                <td>{{ request.car.plate }}</td>
                <td>{{ request.requester.username }}</td>
                <td>{{ request.rent_start_time }}</td>
                <td>{{ request.rent_end_time }}</td>
                <td>{{ request.get_price }}</td>
                <td>
                    <label for="yes{{ forloop.counter }}">Yes</label>
                    <input required type="radio" id="yes{{ forloop.counter }}" name="{{ request.id }}" value="yes">
                    &nbsp;&nbsp;&nbsp;&nbsp;
                    <label for="no{{ forloop.counter }}">No</label>
                    <input type="radio" id="no{{ forloop.counter }}" name="{{ request.id }}" value="no">
                </td>
            </tr>
         {% endfor %}
        </tbody>
        </table>
        <input value="Confirm" type="submit">
        </form>
    {% else %}
        <div class="alert alert-danger"><strong>No Requests.</strong></div>
    {% endif %}
{% else %}
    {% if requests %}
        <table class="table">
        <thead>
        <tr>
            <td>#</td>
            <td>Model</td>
            <td>Owner</td>
            <td>Start Time</td>
            <td>End Time</td>
            <td>Price</td>
            <td>status</td>
        </tr>
        </thead>
        <tbody>
        {% for request in requests %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ request.car.car_type }}</td>
                <td>{{ request.car.owner.username }}</td>
                <td>{{ request.rent_start_time }}</td>
                <td>{{ request.rent_end_time }}</td>
                <td>{{ request.get_price }}</td>
            {% if request.has_result %}
                {% if request.is_accepted %}
                    <td style="color: darkgreen">Accepted</td>
                {% else %}
                    <td style="color: darkred">Rejected</td>
                {% endif %}
            {% else %}
                <td>Not determined yet</td>
            {% endif %}
            </tr>
         {% endfor %}
        </tbody>
        </table>
    {% else %}
        <div class="alert alert-danger"><strong>No Requests.</strong></div>
    {% endif %}

{% endif %}
</div>
</body>
</html>